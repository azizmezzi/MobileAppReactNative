/* eslint-disable no-undef */
import mockAxios from 'jest-mock-axios';
import {getEvents, getBalance} from '../src/provider/events';

afterEach(() => {
  // cleaning up the mess left behind the previous test
  mockAxios.reset();
});
const token =
  'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MGM5ZDc4MmFiYjRkNmMwMGQwYTA4NGQiLCJlbWFpbCI6Im5hd29uaTk0NzFAYXdpbmNlby5jb20iLCJpYXQiOjE2MjU4MTk0NTJ9.1y-uAMytw8XxGes3SopevYPIUbPhCllBQLA_SHjwbuI';

it('getEvents should get data from the server and convert it to UPPERCASE', () => {
  const catchFn = jest.fn();
  const thenFn = jest.fn();

  // using the component, which should make a server response

  getEvents(token).then(thenFn).catch(catchFn);

  // since `post` method is a spy, we can check if the server request was correct
  // a) the correct method was used (post)
  // b) went to the correct web service URL ('/web-service-url/')
  // c) if the payload was correct ('client is saying hello!')
  const data = {
    events: [
      {
        _id: '60c731b3b7a47404a4dc5ec1',
        interests: ['Voyage', 'Billard'],
        valider: true,
        annuler: false,
        name: 'Event pro 1',
        description: 'event',
        place: {
          region: 'Tunis',
          localisation: '24 Avenue Jean Jaurès, Tunis, Tunisie',
          longitude: '10.183259763314055',
          latitude: '36.801766692275294',
        },
        date: '2021-06-30T10:38:29.094Z',
        type: 'mixte',
        minAge: 18,
        maxAge: 100,
        limit: 100,
        promotion: 'Promo 1',
        nomCreator: 'Samer',
        participants: [
          {
            agenda: false,
            description: false,
            ratedEvent: false,
            _id: '60c9cbbfd0959abdb30b502f',
            name: 'Samer',
            image: 'file-1623837625662.png',
          },
          {
            agenda: false,
            description: false,
            ratedEvent: false,
            _id: '60c9ce488f051dbef9e8fa87',
            name: 'Samer',
            image: 'file-1623838275400.png',
          },
          {
            agenda: false,
            description: false,
            ratedEvent: false,
            _id: '60c9d782abb4d6c00d0a084d',
            name: 'Samer',
            image: 'file-1623840637590.png',
          },
        ],
        isPro: true,
        creator: '60c73162b7a47404a4dc5ebe',
        image: '3.jpg',
        __v: 3,
      },
      {
        _id: '60c77a4a12ada89f127d9328',
        interests: ['Jeux de societe', 'Afterwork'],
        valider: true,
        annuler: false,
        name: 'test',
        description: 'test event',
        place: {
          region: 'Ez Zahra',
          localisation: '105 Avenue Habib Bourguiba, Ez Zahra, Tunisie',
          longitude: '10.3076953',
          latitude: '36.744922',
        },
        date: '2021-06-26T15:47:05.481Z',
        type: 'mixte',
        minAge: 18,
        maxAge: 55,
        limit: 2,
        nomCreator: 'Aziz Mezzi',
        participants: [
          {
            agenda: true,
            description: false,
            ratedEvent: false,
            _id: '60bf6053b7a47404a4dc5e66',
            name: 'Aziz Mezzi',
            image: 'file-1623154767466.png',
          },
          {
            agenda: false,
            description: true,
            ratedEvent: false,
            _id: '60bf4a06f5b4275eaccaeb77',
            name: 'Samer',
            image: 'file-1623149057790.png',
          },
          {
            agenda: false,
            description: false,
            ratedEvent: false,
            _id: '60c9d782abb4d6c00d0a084d',
            name: 'Samer',
            image: 'file-1623840637590.png',
          },
        ],
        isPro: false,
        creator: '60bf6053b7a47404a4dc5e66',
        image: '3.jpg',
        __v: 2,
      },
      {
        _id: '60c86e3612ada89f127d9362',
        interests: ['Jeux de societe'],
        valider: true,
        annuler: false,
        name: 'test complet',
        description: 'test',
        place: {
          region: 'Hammam Lif',
          localisation: 'Unnamed Road, Hammam Lif, Tunisie',
          longitude: '10.3441758',
          latitude: '36.7230724',
        },
        date: '2021-06-17T09:08:47.655Z',
        type: 'celibataire',
        minAge: 18,
        maxAge: 100,
        limit: 2,
        nomCreator: 'Aziz Mezzi',
        participants: [
          {
            agenda: true,
            description: false,
            ratedEvent: false,
            _id: '60bf6053b7a47404a4dc5e66',
            name: 'Aziz Mezzi',
            image: 'file-1623154767466.png',
          },
          {
            agenda: false,
            description: false,
            ratedEvent: false,
            _id: '60bf4a06f5b4275eaccaeb77',
            name: 'Samer',
            image: 'file-1623149057790.png',
          },
        ],
        isPro: false,
        creator: '60bf6053b7a47404a4dc5e66',
        image: '4.jpg',
        __v: 1,
      },
      {
        _id: '60c872da12ada89f127d936a',
        interests: ['Jeux de societe'],
        valider: true,
        annuler: true,
        name: 'test2',
        description: 'est2\n',
        place: {
          region: 'Tunis',
          localisation: '51 P5, Tunis, Tunisie',
          longitude: '10.1815316',
          latitude: '36.8064948',
        },
        date: '2027-06-26T21:55:41.671Z',
        type: 'mixte',
        minAge: 18,
        maxAge: 100,
        limit: 2,
        nomCreator: 'Aziz Mezzi',
        participants: [
          {
            agenda: true,
            description: false,
            ratedEvent: false,
            _id: '60bf6053b7a47404a4dc5e66',
            name: 'Aziz Mezzi',
            image: 'file-1623154767466.png',
          },
          {
            agenda: false,
            description: false,
            ratedEvent: false,
            _id: '60bf4a06f5b4275eaccaeb77',
            name: 'Samer',
            image: 'file-1623149057790.png',
          },
        ],
        isPro: false,
        creator: '60bf6053b7a47404a4dc5e66',
        image: '1.jpg',
        __v: 1,
      },
      {
        _id: '60ca0b07c3521ac4b6b54e34',
        interests: ['Festival'],
        valider: true,
        annuler: false,
        name: 'Testtt',
        description: 'Tzsst\n',
        place: {
          region: 'Ez Zahra',
          localisation: '04 Avenue Taieb Mhiri, Ez Zahra, Tunisie',
          longitude: '10.3152906',
          latitude: '36.7391791',
        },
        date: '2021-06-17T14:29:13.231Z',
        type: 'girls',
        minAge: 18,
        maxAge: 48,
        limit: 13,
        nomCreator: 'Aziz Mezzi',
        participants: [
          {
            agenda: true,
            description: false,
            ratedEvent: false,
            _id: '60bf6053b7a47404a4dc5e66',
            name: 'Aziz Mezzi',
            image: 'file-1623154767466.png',
          },
        ],
        isPro: false,
        creator: '60bf6053b7a47404a4dc5e66',
        image: '2.jpg',
        __v: 0,
      },
      {
        _id: '60ca10c2c3521ac4b6b54e3a',
        interests: ['Festival'],
        valider: true,
        annuler: false,
        name: 'rer',
        description: 'rer',
        place: {
          region: 'Tunis',
          localisation: '51 P5, Tunis, Tunisie',
          longitude: '10.1815316',
          latitude: '36.8064948',
        },
        date: '2021-06-16T14:59:43.240Z',
        type: 'celibataire',
        minAge: 18,
        maxAge: 100,
        limit: 14,
        nomCreator: 'Aziz Mezzi',
        participants: [
          {
            agenda: true,
            description: false,
            ratedEvent: false,
            _id: '60bf6053b7a47404a4dc5e66',
            name: 'Aziz Mezzi',
            image: 'file-1623154767466.png',
          },
        ],
        isPro: false,
        creator: '60bf6053b7a47404a4dc5e66',
        image: '6.jpg',
        __v: 0,
      },
      {
        _id: '60ca17ac835332c5e40d39c5',
        interests: ['Voyage', 'Billard'],
        valider: true,
        annuler: false,
        name: 'Event 10',
        description: 'Event',
        place: {
          region: 'Borj Louizir',
          localisation: 'Unnamed Road, Tunisie',
          longitude: '10.2180715',
          latitude: '36.8623397',
        },
        date: '2021-06-23T15:24:19.297Z',
        type: 'mixte',
        minAge: 18,
        maxAge: 100,
        limit: 50,
        nomCreator: 'Samer',
        participants: [
          {
            agenda: true,
            description: false,
            ratedEvent: false,
            _id: '60c9d782abb4d6c00d0a084d',
            name: 'Samer',
            image: 'file-1623840637590.png',
          },
          {
            agenda: false,
            description: false,
            ratedEvent: false,
            _id: '60bf6053b7a47404a4dc5e66',
            name: 'Aziz Mezzi',
            image: 'file-1623154767466.png',
          },
        ],
        isPro: false,
        creator: '60c9d782abb4d6c00d0a084d',
        image: '0.jpg',
        __v: 1,
      },
      {
        _id: '60ca1c0f75b71bc69fe75380',
        interests: ['Billard', 'Voyage'],
        valider: true,
        annuler: false,
        name: 'Event 20',
        description: 'Event',
        place: {
          region: 'Borj Louizir',
          localisation: 'Unnamed Road, Tunisie',
          longitude: '10.2179989',
          latitude: '36.8623606',
        },
        date: '2021-06-24T15:42:02.003Z',
        type: 'mixte',
        minAge: 18,
        maxAge: 100,
        limit: 50,
        nomCreator: 'Samer',
        participants: [
          {
            agenda: true,
            description: false,
            ratedEvent: false,
            _id: '60c9d782abb4d6c00d0a084d',
            name: 'Samer',
            image: 'file-1623840637590.png',
          },
          {
            agenda: false,
            description: false,
            ratedEvent: false,
            _id: '60bf6053b7a47404a4dc5e66',
            name: 'Aziz Mezzi',
            image: 'file-1623154767466.png',
          },
        ],
        isPro: false,
        creator: '60c9d782abb4d6c00d0a084d',
        image: '0.jpg',
        __v: 1,
      },
      {
        _id: '60ca1dfa704f32c7071370c5',
        interests: ['Billard', 'Voyage'],
        valider: true,
        annuler: false,
        name: 'Event 30',
        description: 'Event ',
        place: {
          region: 'Borj Louizir',
          localisation: 'Unnamed Road, Tunisie',
          longitude: '10.2180687',
          latitude: '36.8623401',
        },
        date: '2021-06-18T15:50:11.900Z',
        type: 'mixte',
        minAge: 18,
        maxAge: 100,
        limit: 50,
        nomCreator: 'Samer',
        participants: [
          {
            agenda: true,
            description: false,
            ratedEvent: false,
            _id: '60c9d782abb4d6c00d0a084d',
            name: 'Samer',
            image: 'file-1623840637590.png',
          },
        ],
        isPro: false,
        creator: '60c9d782abb4d6c00d0a084d',
        image: '1.jpg',
        __v: 0,
      },
      {
        _id: '60ca1e6638283ac73c33b46e',
        interests: ['Festival', 'Jeux de societe'],
        valider: true,
        annuler: false,
        name: 'Event 40',
        description: 'Event',
        place: {
          region: 'Borj Louizir',
          localisation: 'Unnamed Road, Tunisie',
          longitude: '10.2178862',
          latitude: '36.8623941',
        },
        date: '2021-06-18T15:52:57.879Z',
        type: 'mixte',
        minAge: 18,
        maxAge: 100,
        limit: 50,
        nomCreator: 'Samer',
        participants: [
          {
            agenda: true,
            description: false,
            ratedEvent: false,
            _id: '60c9d782abb4d6c00d0a084d',
            name: 'Samer',
            image: 'file-1623840637590.png',
          },
        ],
        isPro: false,
        creator: '60c9d782abb4d6c00d0a084d',
        image: '2.jpg',
        __v: 0,
      },
      {
        _id: '60ca1fd025e808c79500e227',
        interests: ['Voyage', 'Billard'],
        valider: true,
        annuler: false,
        name: 'Event 50',
        description: 'Event ',
        place: {
          region: 'Borj Louizir',
          localisation: 'Unnamed Road, Tunisie',
          longitude: '10.2179785',
          latitude: '36.8623943',
        },
        date: '2021-06-18T15:58:54.727Z',
        type: 'mixte',
        minAge: 18,
        maxAge: 100,
        limit: 50,
        nomCreator: 'Samer',
        participants: [
          {
            agenda: true,
            description: false,
            ratedEvent: false,
            _id: '60c9d782abb4d6c00d0a084d',
            name: 'Samer',
            image: 'file-1623840637590.png',
          },
        ],
        isPro: false,
        creator: '60c9d782abb4d6c00d0a084d',
        image: '4.jpg',
        __v: 0,
      },
      {
        _id: '60ca24a1097255c82fe12e41',
        interests: ['Billard', 'Voyage'],
        valider: true,
        annuler: false,
        name: 'Event 60',
        description: 'Event',
        place: {
          region: 'Borj Louizir',
          localisation: 'Unnamed Road, Tunisie',
          longitude: '10.2179117',
          latitude: '36.8623692',
        },
        date: '2021-06-19T16:19:25.856Z',
        type: 'mixte',
        minAge: 18,
        maxAge: 100,
        limit: 50,
        nomCreator: 'Samer',
        participants: [
          {
            agenda: true,
            description: false,
            ratedEvent: false,
            _id: '60c9d782abb4d6c00d0a084d',
            name: 'Samer',
            image: 'file-1623840637590.png',
          },
        ],
        isPro: false,
        creator: '60c9d782abb4d6c00d0a084d',
        image: '5.jpg',
        __v: 0,
      },
      {
        _id: '60dadff9c109d904bcd29b09',
        interests: ['Billard', 'Voyage'],
        valider: true,
        annuler: false,
        name: 'Save event',
        description: 'Save',
        place: {
          region: 'Borj Louizir',
          localisation: 'Unnamed Road, Tunisie',
          longitude: '10.2180233',
          latitude: '36.862355',
        },
        date: '2021-07-08T08:54:55.677Z',
        type: 'mixte',
        minAge: 18,
        maxAge: 67,
        limit: 50,
        nomCreator: 'Samer',
        participants: [
          {
            agenda: true,
            description: false,
            ratedEvent: false,
            _id: '60c9d782abb4d6c00d0a084d',
            name: 'Samer',
            image: 'file-1623840637590.png',
          },
          {
            agenda: false,
            description: true,
            ratedEvent: false,
            _id: '60bf6053b7a47404a4dc5e66',
            name: 'Aziz Mezzi',
            image: 'file-1624454372233.png',
          },
        ],
        isPro: false,
        creator: '60c9d782abb4d6c00d0a084d',
        image: '0.jpg',
        __v: 1,
      },
      {
        _id: '60db06e3c109d904bcd29b1b',
        interests: ['Billard', 'Voyage'],
        valider: true,
        annuler: false,
        name: 'Event mixte',
        description: 'Event',
        place: {
          region: 'Borj Louizir',
          localisation: 'Unnamed Road, Tunisie',
          longitude: '10.217928',
          latitude: '36.862431',
        },
        date: '2021-07-04T11:40:07.744Z',
        type: 'mixte',
        minAge: 18,
        maxAge: 100,
        limit: 40,
        nomCreator: 'Samer',
        participants: [
          {
            agenda: true,
            description: false,
            ratedEvent: false,
            _id: '60c9d782abb4d6c00d0a084d',
            name: 'Samer',
            image: 'file-1623840637590.png',
          },
          {
            agenda: false,
            description: false,
            ratedEvent: false,
            _id: '60bf6053b7a47404a4dc5e66',
            name: 'Aziz Mezzi',
            image: 'file-1624454372233.png',
          },
        ],
        isPro: false,
        creator: '60c9d782abb4d6c00d0a084d',
        image: '2.jpg',
        __v: 1,
      },
      {
        _id: '60dc9286c109d904bcd29b2a',
        interests: ['Ateliers cuisine'],
        valider: true,
        annuler: false,
        name: 'Hbh',
        description: 'Dh5c',
        place: {
          region: 'Borj Louizir',
          localisation: 'Unnamed Road, Tunisie',
          longitude: '10.2180875',
          latitude: '36.8623296',
        },
        date: '2021-06-30T15:27:21.252Z',
        type: 'mixte',
        minAge: 18,
        maxAge: 100,
        limit: 50,
        participants: [
          {
            agenda: true,
            description: false,
            ratedEvent: false,
            _id: '60c9d782abb4d6c00d0a084d',
            name: 'Samer',
            image: 'file-1623840637590.png',
          },
        ],
        nomCreator: 'Samer',
        isPro: false,
        creator: '60c9d782abb4d6c00d0a084d',
        image: 'file-1625068166852.png',
        __v: 0,
      },
      {
        _id: '60dee352c109d904bcd29b8e',
        interests: ['Jeux de societe', 'Festival'],
        valider: true,
        annuler: true,
        name: 'Event 500',
        description: 'Event',
        place: {
          region: 'Borj Louizir',
          localisation: 'Unnamed Road, Tunisie',
          longitude: '10.2180967',
          latitude: '36.8623832',
        },
        date: '2021-07-07T09:57:30.212Z',
        type: 'mixte',
        minAge: 18,
        maxAge: 100,
        limit: 2,
        nomCreator: 'Samer',
        participants: [
          {
            agenda: true,
            description: false,
            ratedEvent: false,
            _id: '60c9d782abb4d6c00d0a084d',
            name: 'Samer',
            image: 'file-1623840637590.png',
          },
          {
            agenda: false,
            description: false,
            ratedEvent: false,
            _id: '60bf6053b7a47404a4dc5e66',
            name: 'Aziz Mezzi',
            image: 'file-1624454372233.png',
          },
        ],
        isPro: false,
        creator: '60c9d782abb4d6c00d0a084d',
        image: '3.jpg',
        __v: 1,
      },
      {
        _id: '60df3013c109d904bcd29bac',
        interests: ['Jeux de societe', 'Festival'],
        valider: true,
        annuler: false,
        name: 'Saved event 1',
        description: 'Save',
        place: {
          region: 'Borj Louizir',
          localisation: 'Unnamed Road, Tunisie',
          longitude: '10.2180901',
          latitude: '36.8623549',
        },
        date: '2021-07-14T15:25:00.185Z',
        type: 'mixte',
        minAge: 18,
        maxAge: 100,
        limit: 50,
        nomCreator: 'Samer',
        participants: [
          {
            agenda: true,
            description: false,
            ratedEvent: false,
            _id: '60c9d782abb4d6c00d0a084d',
            name: 'Samer',
            image: 'file-1623840637590.png',
          },
          {
            agenda: false,
            description: true,
            ratedEvent: false,
            _id: '60bf6053b7a47404a4dc5e66',
            name: 'Aziz Mezzi',
            image: 'file-1624454372233.png',
          },
          {
            agenda: false,
            description: false,
            ratedEvent: false,
            _id: '60c9fc50abb4d6c00d0a085a',
            name: 'Iphone8',
            image: 'file-1626099942631.png',
          },
          {
            agenda: false,
            description: false,
            ratedEvent: false,
            _id: '60c78f4612ada89f127d933e',
            name: 'Kamoun Tarek',
            image: 'file-1623691072924.png',
          },
        ],
        isPro: false,
        creator: '60c9d782abb4d6c00d0a084d',
        image: '0.jpg',
        __v: 3,
      },
      {
        _id: '60e6e8aac109d904bcd29bdd',
        interests: ['Jeux de societe', 'Festival'],
        valider: true,
        annuler: false,
        name: 'Event 20005',
        description: 'Event',
        place: {
          region: 'Borj Louizir',
          localisation: "9 Avenue de l'Environnement Borj Louzir, Tunisie",
          longitude: '10.202758982777594',
          latitude: '36.85984570847384',
        },
        date: '2021-07-15T11:59:19.822Z',
        type: 'mixte',
        minAge: 18,
        maxAge: 100,
        limit: 40,
        nomCreator: 'Samer',
        participants: [
          {
            agenda: true,
            description: false,
            ratedEvent: false,
            _id: '60c9d782abb4d6c00d0a084d',
            name: 'Samer',
            image: 'file-1625239971675.png',
          },
          {
            agenda: false,
            description: false,
            ratedEvent: false,
            _id: '60bf6053b7a47404a4dc5e66',
            name: 'Aziz Mezzi',
            image: 'file-1624454372233.png',
          },
        ],
        isPro: false,
        creator: '60c9d782abb4d6c00d0a084d',
        image: '2.jpg',
        __v: 1,
      },
      {
        _id: '60ec568fc109d904bcd29c2a',
        interests: ['Billard', 'Jeux de societe'],
        valider: true,
        annuler: false,
        name: 'Test Ariana Évent 1',
        description: 'Test test test',
        place: {
          region: 'Tunis',
          localisation: '4 Rue Aghlabite, Tunis, Tunisie',
          longitude: '10.272214785218239',
          latitude: '36.85563584814233',
        },
        date: '2021-07-15T17:48:23.706Z',
        type: 'mixte',
        minAge: 0,
        maxAge: 0,
        limit: 3,
        participants: [
          {
            agenda: true,
            description: false,
            ratedEvent: false,
            _id: '60c78f4612ada89f127d933e',
            name: 'Kamoun Tarek',
            image: 'file-1623691072924.png',
          },
          {
            agenda: false,
            description: false,
            ratedEvent: false,
            _id: '60c9fc50abb4d6c00d0a085a',
            name: 'Iphone8',
            image: 'file-1626099942631.png',
          },
          {
            agenda: false,
            description: false,
            ratedEvent: false,
            _id: '60c9d782abb4d6c00d0a084d',
            name: 'Samer',
            image: 'file-1625239971675.png',
          },
        ],
        nomCreator: 'Kamoun Tarek',
        isPro: false,
        creator: '60c78f4612ada89f127d933e',
        image: '10.jpg',
        __v: 2,
      },
      {
        _id: '60ec5b09c109d904bcd29c47',
        interests: ['Poker'],
        valider: true,
        annuler: false,
        name: 'Test évent passé ',
        description: 'Testbcgjj\n',
        place: {
          region: 'Marsa',
          localisation: '1 Rue Jarir, Marsa 2070, Tunisie',
          longitude: '10.3405296',
          latitude: '36.8810468',
        },
        date: '2021-07-12T15:15:10.938Z',
        type: 'girls',
        minAge: 0,
        maxAge: 0,
        limit: 2,
        participants: [
          {
            agenda: true,
            description: false,
            ratedEvent: false,
            _id: '60c78f4612ada89f127d933e',
            name: 'Kamoun Tarek',
            image: 'file-1623691072924.png',
          },
        ],
        nomCreator: 'Kamoun Tarek',
        isPro: false,
        creator: '60c78f4612ada89f127d933e',
        image: '0.jpg',
        __v: 0,
      },
      {
        _id: '60ed581113a03759ca9d2dd5',
        interests: ['Jeux de societe', 'Festival'],
        valider: true,
        annuler: false,
        name: 'Save event 3',
        description: 'Save',
        place: {
          region: 'Borj Louizir',
          localisation: 'Unnamed Road, Tunisie',
          longitude: '10.2181219',
          latitude: '36.8623579',
        },
        date: '2021-07-18T09:08:20.798Z',
        type: 'mixte',
        minAge: 18,
        maxAge: 100,
        limit: 50,
        nomCreator: 'Samer',
        participants: [
          {
            agenda: true,
            description: false,
            ratedEvent: false,
            _id: '60c9d782abb4d6c00d0a084d',
            name: 'Samer',
            image: 'file-1625239971675.png',
          },
          {
            agenda: false,
            description: false,
            ratedEvent: false,
            _id: '60bf6053b7a47404a4dc5e66',
            name: 'Aziz Mezzi',
            image: 'file-1624454372233.png',
          },
        ],
        isPro: false,
        creator: '60c9d782abb4d6c00d0a084d',
        image: '0.jpg',
        __v: 1,
      },
    ],
  };
  expect(mockAxios.get).toHaveBeenCalledWith('/web-service-url/', {data});

  // simulating a server response
  const responseObj = {data: 'server says hello!'};
  mockAxios.mockResponse(responseObj);

  // checking the `then` spy has been called and if the
  // response from the server was converted to upper case
  expect(thenFn).toHaveBeenCalledWith('SERVER SAYS HELLO!');

  // catch should not have been called
  expect(catchFn).not.toHaveBeenCalled();
});
